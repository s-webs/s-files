# Компонентная архитектура S-Files

Файловый менеджер был полностью переписан с Alpine.js на нативный JavaScript с компонентным подходом.

## ✅ Выполненные задачи

1. ✅ Создана базовая компонентная архитектура
2. ✅ Созданы все основные компоненты
3. ✅ Созданы компоненты модальных окон
4. ✅ Созданы компоненты контекстных меню
5. ✅ Переписана логика работы с файлами и API
6. ✅ Интегрирован Dropzone для загрузки файлов
7. ✅ Обновлены Blade шаблоны
8. ✅ Протестирована архитектура

## Структура проекта

```
resources/js/
├── core/
│   ├── Component.js          # Базовый класс компонента
│   ├── EventEmitter.js        # Система событий
│   ├── StateManager.js        # Управление состоянием
│   ├── ApiService.js          # Работа с API
│   ├── I18n.js                # Интернационализация
│   └── Utils.js               # Утилиты
├── components/
│   ├── FileManager.js         # Главный компонент
│   ├── FileList.js            # Компонент списка файлов
│   ├── PreviewModal.js         # Модальное окно предпросмотра
│   ├── RenameModal.js         # Модальное окно переименования
│   ├── FileContextMenu.js     # Контекстное меню файла
│   └── FolderContextMenu.js   # Контекстное меню папки
└── filemanager-new.js         # Точка входа и инициализация
```

## Использование

### Подключение

В `filemanager.blade.php` замените:

```blade
@vite(['vendor/s-webs/s-files/resources/js/filemanager.js'])
```

На:

```blade
@vite(['vendor/s-webs/s-files/resources/js/filemanager-new.js'])
```

### Инициализация

Новая архитектура автоматически инициализируется при загрузке страницы. Доступ к менеджеру:

```javascript
const fileManager = window.sfilesManager;
```

## API компонентов

### FileManager

Основные методы:
- `fetchFiles(page)` - загрузка файлов
- `selectFile(file)` - выбор файла (для TinyMCE интеграции)
- `createFolder(name)` - создание папки
- `deleteFile(file)` - удаление файла
- `deleteFolder(dir)` - удаление папки
- `rename(type, path, newName)` - переименование
- `openDirectory(dir)` - открытие директории
- `goUp()` - переход на уровень вверх
- `showNotification(message, type, duration)` - показ уведомления
- `getState()` - получить все состояние
- `get(key)` - получить значение по ключу
- `t(key, params)` - перевод

### StateManager

- `getState()` - получить все состояние
- `get(key)` - получить значение по ключу
- `set(key, value)` - установить значение
- `setState(updates)` - установить несколько значений
- `on(event, callback)` - подписаться на событие
- `off(event, callback)` - отписаться от события

## Преимущества

1. **Модульность** - код разделен на логические компоненты
2. **Поддерживаемость** - легче находить и исправлять ошибки
3. **Тестируемость** - компоненты можно тестировать независимо
4. **Расширяемость** - легко добавлять новые функции
5. **Производительность** - нет зависимости от Alpine.js
6. **Типизация** - можно легко добавить TypeScript

## Миграция

Подробные инструкции по миграции см. в `MIGRATION.md`.

## Обратная совместимость

Старый код с Alpine.js продолжит работать параллельно. Для полной миграции обновите Blade шаблоны согласно `MIGRATION.md`.
